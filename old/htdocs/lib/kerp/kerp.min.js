console.dir(KISP),function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){var A=function(){function a(a,b){e[a]={required:!1,exports:b,exposed:!1}}function b(a){var c=e[a];if(c){var d=c.exports;if(c.required)return d;if("function"==typeof d){var f=d;d={};var g={id:a,exports:d},h=f(b,g,d);d=h===z?g.exports:h,c.exports=d}return c.required=!0,d}}function c(a,c){var d=b(a);if(d){var f=e[a].exposed;return void(c&&c(f?d:null))}var g=b("$"),h=b("Url"),i=h.format("{~}lib/kerp/{0}.{@}.js",a);g.Script.load(i,function(){d=b(a);var f=e[a].exposed;c&&c(f?d:null)})}function d(a,b){function c(a){var b=e[a];return b?b.exposed:!1}function d(a,b){var c=e[a];c&&(c.exposed=!!b)}return"object"==typeof a?void m.Object.each(a,function(a,b){d(a,b)}):2==arguments.length?void d(a,b):c(a)}var e={};return{define:a,require:b,async:c,expose:d}}(),B=A.define,C=A.require;B("$",function(a,b,c){return m}),B("MiniQuery",function(a,b,c){return o}),B("API",function(a,b,c){function e(a){try{return d.JSON.parse(a)}catch(b){}try{return a=a.replace(/^(\r\n)+/g,""),new t("return "+a)()}catch(b){}return null}function f(a){if(!j.request(a)){var b=o.url+a.name+".do",c=(a.method||"get").toLowerCase(),d=a.data||null;if(d)if(d=h.Object.map(d,function(a,b){return"object"==typeof b&&b?h.Object.toJson(b):b}),d=h.Object.toQueryString(d),"get"==c)b+="?"+d,d=null;else{var f=a.query;f&&(f=h.Object.toQueryString(f),b+="?"+f)}var g=new XMLHttpRequest;g.open(c,b,!0),g.onreadystatechange=function(){if(4==g.readyState){var b=o.codes.success,c=a.error;if(g.status!=b)return void(c&&c(g));var d=e(g.responseText);if(!d)return void(c&&c(g));var f=d.code;if(f==b){var h=a.success;h&&h(d.data||{},d,g)}else{var i=a.fail;i&&i(f,d.msg,d,g)}}},"post"==c&&g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),g.send(d)}}function g(a,b){"object"==typeof a&&(b=a,a=b.name),b=b||{},this[n]="API-"+h.String.random();var c=o.codes,d=new l(this),e={name:a,data:b.data,query:b.query,status:"",args:[],emitter:d};m.set(this,e),h.Object.extend(e,{fireEvent:function(a,b){a=e.status=a||e.status,b=e.args=b||e.args,d.fire("done",b),d.fire(a,b),"success"==a?d.fire(c.success,b):"fail"==a&&d.fire(b.shift(),b)},success:function(a,b,c){e.fireEvent("success",[a,b,c])},fail:function(a,b,c,d){e.fireEvent("fail",[a,b,c,d])},error:function(a){e.fireEvent("error",[a])}});var f=this;h.Array.each(["done","success","fail","error",c.success],function(a,c){a=a.toString();var d=b[a];d&&f.on(a,d)})}var h=a("$"),i=a("MiniQuery"),j=a("Proxy"),k=i.require("Mapper"),l=i.require("Emitter"),m=new k,n=k.getGuidKey(),o={};return g.prototype={constructor:g,get:function(a){var b=m.get(this);return f({method:"get",name:b.name,data:a||b.data,success:b.success,fail:b.fail,error:b.error}),this},post:function(a,b){var c=m.get(this);return f({method:"post",name:c.name,data:a||c.data,query:b||c.query,success:c.success,fail:c.fail,error:c.error}),this},done:function(a){return this.on("done",a),this},success:function(a){return this.on("success",a),this},fail:function(a){return this.on("fail",a),this},error:function(a){return this.on("error",a),this},on:function(a,b){var c=m.get(this),d=c.emitter,e=[].slice.call(arguments,0);return d.on.apply(d,e),c.status&&c.fireEvent(),this},off:function(a,b){var c=m.get(this),d=c.emitter,e=[].slice.call(arguments,0);return d.off.apply(d,e),this}},h.Object.extend(g,{ajax:f,config:function(a){h.Object.extend(o,a)}})}),B("Proxy",function(a,b,c){function e(a){try{return d.JSON.parse(a)}catch(b){try{return a=a.replace(/^(\r\n)+/g,""),new t("return "+a)()}catch(b){return null}}return null}function f(a){if(a){var b=[].slice.call(arguments,1),c=l.Math.randomInt(500,3e3);k(function(){a.apply(null,b)},c)}}function g(a){var b=a.name,c=q[b];if(c instanceof p&&(c=c.pop()),!c)return!1;if(o.isJs(c)){var d=m.check(c)?c:m.root()+c;return d=l.require("Url").randomQueryString(d),r[d]=a,n.use(d,function(b){if(!b)return void f(a.error);var c=b.code;200==c?f(a.success,b.data||{},b):f(a.fail,c,b.msg,b)}),!0}c===!0&&(c=b+".json");var d=m.root()+c+"?r="+u.random(),g=new XMLHttpRequest;return g.open("get",d,!0),g.onreadystatechange=function(){if(4==g.readyState){if(200!=g.status)return void f(a.error);var b=e(g.responseText);if(!b)return void f(a.error);var c=b.code;200==c?f(a.success,b.data||{},b):f(a.fail,c,b.msg,b)}},g.send(null),!0}function h(a,b){d.seajs.Module.define(function(c,d,e){var f=j(e),g=f.data;if(l.Object.isPlain(a))return a;var h="function"==typeof a?a:b[g[a]];return h?h(g,f)||{}:{}})}function i(a){return a?void l.Object.extend(q,a):l.Object.extend({},q)}function j(a){"object"==typeof a&&(a=a.uri);var b=r[a];return delete r[a],b}var l=a("$"),m=a("Url"),n=(a("Debug"),a("Seajs")),o=a("File"),q={},r={};return{request:g,response:h,config:i}}),B("MD5",function(a,b,c){function d(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,e=-1732584194,k=271733878,l=0;l<a.length;l+=16){var m=c,n=d,o=e,q=k;c=f(c,d,e,k,a[l+0],7,-680876936),k=f(k,c,d,e,a[l+1],12,-389564586),e=f(e,k,c,d,a[l+2],17,606105819),d=f(d,e,k,c,a[l+3],22,-1044525330),c=f(c,d,e,k,a[l+4],7,-176418897),k=f(k,c,d,e,a[l+5],12,1200080426),e=f(e,k,c,d,a[l+6],17,-1473231341),d=f(d,e,k,c,a[l+7],22,-45705983),c=f(c,d,e,k,a[l+8],7,1770035416),k=f(k,c,d,e,a[l+9],12,-1958414417),e=f(e,k,c,d,a[l+10],17,-42063),d=f(d,e,k,c,a[l+11],22,-1990404162),c=f(c,d,e,k,a[l+12],7,1804603682),k=f(k,c,d,e,a[l+13],12,-40341101),e=f(e,k,c,d,a[l+14],17,-1502002290),d=f(d,e,k,c,a[l+15],22,1236535329),c=g(c,d,e,k,a[l+1],5,-165796510),k=g(k,c,d,e,a[l+6],9,-1069501632),e=g(e,k,c,d,a[l+11],14,643717713),d=g(d,e,k,c,a[l+0],20,-373897302),c=g(c,d,e,k,a[l+5],5,-701558691),k=g(k,c,d,e,a[l+10],9,38016083),e=g(e,k,c,d,a[l+15],14,-660478335),d=g(d,e,k,c,a[l+4],20,-405537848),c=g(c,d,e,k,a[l+9],5,568446438),k=g(k,c,d,e,a[l+14],9,-1019803690),e=g(e,k,c,d,a[l+3],14,-187363961),d=g(d,e,k,c,a[l+8],20,1163531501),c=g(c,d,e,k,a[l+13],5,-1444681467),k=g(k,c,d,e,a[l+2],9,-51403784),e=g(e,k,c,d,a[l+7],14,1735328473),d=g(d,e,k,c,a[l+12],20,-1926607734),c=h(c,d,e,k,a[l+5],4,-378558),k=h(k,c,d,e,a[l+8],11,-2022574463),e=h(e,k,c,d,a[l+11],16,1839030562),d=h(d,e,k,c,a[l+14],23,-35309556),c=h(c,d,e,k,a[l+1],4,-1530992060),k=h(k,c,d,e,a[l+4],11,1272893353),e=h(e,k,c,d,a[l+7],16,-155497632),d=h(d,e,k,c,a[l+10],23,-1094730640),c=h(c,d,e,k,a[l+13],4,681279174),k=h(k,c,d,e,a[l+0],11,-358537222),e=h(e,k,c,d,a[l+3],16,-722521979),d=h(d,e,k,c,a[l+6],23,76029189),c=h(c,d,e,k,a[l+9],4,-640364487),k=h(k,c,d,e,a[l+12],11,-421815835),e=h(e,k,c,d,a[l+15],16,530742520),d=h(d,e,k,c,a[l+2],23,-995338651),c=i(c,d,e,k,a[l+0],6,-198630844),k=i(k,c,d,e,a[l+7],10,1126891415),e=i(e,k,c,d,a[l+14],15,-1416354905),d=i(d,e,k,c,a[l+5],21,-57434055),c=i(c,d,e,k,a[l+12],6,1700485571),k=i(k,c,d,e,a[l+3],10,-1894986606),e=i(e,k,c,d,a[l+10],15,-1051523),d=i(d,e,k,c,a[l+1],21,-2054922799),c=i(c,d,e,k,a[l+8],6,1873313359),k=i(k,c,d,e,a[l+15],10,-30611744),e=i(e,k,c,d,a[l+6],15,-1560198380),d=i(d,e,k,c,a[l+13],21,1309151649),c=i(c,d,e,k,a[l+4],6,-145523070),k=i(k,c,d,e,a[l+11],10,-1120210379),e=i(e,k,c,d,a[l+2],15,718787259),d=i(d,e,k,c,a[l+9],21,-343485551),c=j(c,m),d=j(d,n),e=j(e,o),k=j(k,q)}return p(c,d,e,k)}function e(a,b,c,d,e,f){return j(k(j(j(b,a),j(d,f)),e),c)}function f(a,b,c,d,f,g,h){return e(b&c|~b&d,a,b,f,g,h)}function g(a,b,c,d,f,g,h){return e(b&d|c&~d,a,b,f,g,h)}function h(a,b,c,d,f,g,h){return e(b^c^d,a,b,f,g,h)}function i(a,b,c,d,f,g,h){return e(c^(b|~d),a,b,f,g,h)}function j(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function k(a,b){return a<<b|a>>>32-b}function l(a){for(var b=p(),c=(1<<o)-1,d=0;d<a.length*o;d+=o)b[d>>5]|=(a.charCodeAt(d/o)&c)<<d%32;return b}function m(a){for(var b=n?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>d%4*8+4&15)+b.charAt(a[d>>2]>>d%4*8&15);return c}var n=0,o=8;return{encrypt:function(a){return arguments.length>1&&(a=[].slice.call(arguments,0).join("")),m(d(l(a),a.length*o))}}}),B("Cache",function(a,c,e){function f(a,b){return a in j?j[a]:(j[a]=b,b)}function g(a,b){j[a]=b}function h(a){delete j[a]}function i(a){return a in j}if(d!==b)return b.KERP.require("Cache");var j={};return{get:f,set:g,remove:h,has:i}}),B("Config",function(a,b,c){function d(a){return f.Object.map(a,function(a,b){return"string"==typeof b?g.format(b):b instanceof p?f.Array.keep(b,function(a,b){return"string"==typeof a?g.format(a):"object"==typeof a?d(a):a},!0):b},!0)}function e(b){var c=b.Url;c&&g.config(c),f.Object.each(b,function(b,c){if("Url"!=b){var e=a(b);e&&e.config&&(c=d(c),e.config(c))}})}var f=a("$"),g=a("Url");return{set:e}}),B("Debug",function(a,b,c){function d(a){i=!!a}function e(){var a=i?"debug":"min";return j[a]}function f(){return i}function g(a){h.Object.extend(j,a)}var h=a("$"),i=!0,j={debug:"debug",min:"min"};return{set:d,get:e,check:f,config:g}}),B("File",function(a,b,c){function d(a,b){return"string"!=typeof a||"string"!=typeof b?!1:a.slice(0-b.length).toLowerCase()==b.toLowerCase()}function e(a){return d(a,".js")}function f(a){return d(a,".css")}function g(a){return d(a,".json")}return{is:d,isJs:e,isCss:f,isJson:g}}),B("Module",function(a,b,c){function d(a){return e.Object.findKey(g,function(b,c){return c===a})}var e=a("$"),f={},g={};b.exports={define:function(a,b){f[a]={required:!1,exports:b,exposed:!1},g[a]=b},require:function(a){if(0==a.indexOf("/")){var b=d(arguments.callee.caller);if(!b)throw new s('require 时如果指定了以 "/" 开头的短名称，则必须用在 define 的函数体内');a=b+a}var c=f[a];if(c){var e=arguments.callee,g=c.exports;if(c.required)return g;if("function"==typeof g){var h=g;g={};var i={id:a,exports:g},j=h(e,i,g);g=j===z?i.exports:j,c.exports=g}return c.required=!0,g}}}}),B("Multitask",function(a,b,c){function d(a){return h.Array.keep(a,function(a,b){return!1})}function e(a,b){var c=a&&a.length>0;c&&(h.Array.each(a,function(a,b){return a?void 0:(c=!1,!1)}),c&&b&&b(a))}function f(a,b){var c=d(a);h.Array.each(a,function(a,d){if("function"==typeof a)a(function(a,f){c[d]=a,e(c,b)});else{var f=a.fn,g=a.args||[],h=a.context||null;g.push(function(a,f){c[d]=a,e(c,b)}),f.apply(h,g)}})}function g(a,b){var c=d(a),e=0,f=a.length;!function(){var d=arguments.callee,g=a[e];g(function(a){c[e]=a,e++,f>e?d():b&&b(c)})}()}var h=a("$");return{concurrency:f,serial:g}}),B("Seajs",function(a,b,c){function e(a){if(k)return void(a&&a(k));var b=i.format("{~}f/seajs/seajs.mod.{@}.js");h.require("Script").load({url:b,id:"seajsnode",onload:function(){k=d.seajs,k.config(j),a&&a(k)}})}function f(){var a=[].slice.call(arguments,0);e(function(b){b.use.apply(b,a)})}function g(a){h.Object.extend(j,a),k&&k.config(j)}var h=a("$"),i=a("Url"),j=(a("Debug"),{}),k=d.seajs;return{ready:e,use:f,config:g}}),B("Tree",function(a,b,c){function d(a,b,c){if(a instanceof p){var e=l.keep(a,function(a,e){return d(a,b,c)});return l.reduceDimension(e)}var f=a[b];if(!f||!f.length)return c&&c(a),a;var e=l.keep(f,function(a,e){return d(a,b,c)});return e=l.reduceDimension(e),c&&c(a,f),[a].concat(e)}function e(a,b,c){a instanceof p&&l.each(a,function(a,d){e(a,b,c)});var d=a[b];return d&&d.length?(l.each(d,function(a,d){e(a,b,c)}),void(c&&c(a,d))):void(c&&c(a))}function f(a,b){if(a instanceof p&&b instanceof p){var c=b.length;if(a.length!=c)return!1;for(var d=0;c>d;d++){var e=a[d];if(!(o in e))return!1;var f=b[d];if(!(o in f))return!1;if(e[o]!=f[o])return!1}return!0}return o in a&&o in b?a[o]==b[o]:!1}function g(a,b){this[o]=m.random();var c={},d={},e={data:a,childKey:b.childKey,valueKey:b.valueKey,id$node:c,id$info:d};n.set(this,e),this.each(function(a,b){var e=m.random();c[e]=a,a[o]=e;var f=d[e]={isLeaf:!b||!b.length||b.length<0,parentId:null,ids:[]};b&&(f.ids=l.keep(b,function(a,b){var c=a[o],f=d[c];return f.parentId=e,c}))})}var h=a("$"),i=a("MiniQuery"),j=i.require("Mapper"),k=h.Object,l=h.Array,m=h.String,n=new j,o=j.getGuidKey();return g.prototype={constructor:g,linearize:function(a){var b=n.get(this),c=b.data,e=b.childKey,f=d(c,e,a);return f},each:function(a){var b=n.get(this),c=b.data,d=b.childKey;e(c,d,a)},has:function(a){if(!(o in a))return!1;var b=n.get(this),c=b.id$info,d=a[o],e=c[d];return!!e},isLeaf:function(a){if(!this.has(a))throw new s("该节点不属于本树实例对象。");var b=n.get(this),c=b.id$info,d=a[o];return c[d].isLeaf},getParents:function(a){if(!this.has(a))return null;var b=n.get(this),c=b.id$node,d=b.id$info,e=[];do{e.push(a);var f=a[o],g=d[f],h=g.parentId;a=c[h]}while(a);return e.reverse(),e},getChildren:function(a){if(!this.has(a))return null;var b=n.get(this),c=b.id$node,d=b.id$info,e=a[o],f=d[e];return l.keep(f.ids,function(a,b){return c[a]})},getItemsByValues:function(a){var b=n.get(this),c=b.data,d=[c];if(!a||!a.length)return d;var e=b.id$node,f=b.id$info,g=b.valueKey,h=c,i=l.map(a,function(a,b){var c=h[o],d=f[c],i=d.ids;return i&&i.length&&(c=l.findItem(i,function(b,c){var d=e[b];return d[g]===a}))?h=e[c]:void 0});return d.concat(i)},getItemsByIndexes:function(a){var b=n.get(this),c=b.data,d=[c];if(!a||!a.length)return d;var e=b.id$node,f=b.id$info,g=c,h=l.map(a,function(a,b){var c=g[o],d=f[c],h=d.ids;return h&&h.length&&(c=h[a])?g=e[c]:void 0});return d.concat(h)},destroy:function(){n.remove(this)}},k.extend(g,{linearize:d,each:e,same:f})}),B("Url",function(a,b,c){function d(){return j[k]||j["default"]}function e(a){return a?void i.Object.extend(j,a):i.Object.extend({},j)}function g(a){return"string"!=typeof a?!1:0==a.indexOf("http://")||0==a.indexOf("https://")}function h(b,c){var e=a("Debug");if("object"!=typeof c){var f=[].slice.call(arguments,1);c=i.Array.toObject(f),delete c.length}return c=i.Object.extend({"~":d(),"@":e.get()},c),i.String.format(b,c)}var i=a("$"),j={},k=f.host;return i.Object.extend({},{root:d,config:e,check:g,format:h})}),B("Dialog",function(a,c,e){function f(a){j.use("dialog",a)}function g(a){return 0==arguments.length?k:void i.Object.extend(k,a)}function h(a,b){var c=m[b];if(c)return l+a+"-"+c}if(d!==b)return b.KERP.require("Dialog");var i=a("$"),j=a("Seajs"),k={},l="dialog-"+i.String.random()+"-",m={dialog:"dialog",data:"data"};return{use:f,config:g,getKey:h}}),B("Iframe",function(a,c,e){function f(a){if(a){var c=g();return c?c[a]:z}if(r)return r;var e=b.KISP.require("$")("iframe").toArray();return r=m.Array.findItem(e,function(a,b){return a.contentDocument===d.document})}function g(){var a=f();if(!a)return null;var b=a.src;if(s)return m.Object.extend(s,{hash:m.Url.getHash(b),actived:m(a).hasClass("actived")});var c=a.contentDocument.location,d=c.origin+c.pathname,e=a.getAttribute("src"),g=n.require("Url");return s={type:a.getAttribute("data-type"),id:a.id,index:a.getAttribute("data-index"),src:b,originalSrc:e,path:e.split("?")[0],url:d,sn:a.getAttribute("data-sn"),query:g.getQueryString(b),hash:g.getHash(b),actived:m(a).hasClass("actived")}}function h(a,b,c){q.open(a,b,c)}function i(a){var b=f("sn"),c=q.getData(b);return c?0==arguments.length?c:c[a]:void 0}function j(a,b){var c=f("sn");if(1==arguments.length)return b=a,void q.setData(c,b);var d=q.getData(c)||{};d[a]=b,q.setData(c,d)}function k(a){var b=f("sn");if(0==arguments.length)return void q.removeData(b);var c=q.getData(b);c&&(delete c[a],q.setData(b,c))}function l(){var b=a("Dialog"),c=f("sn"),d=b.getKey(c,"dialog");return q.getData(d)}if(d===b)return a("IframeManager");var m=a("$"),n=a("MiniQuery"),o=n.require("Emitter"),p=new o,q=b.KERP.require("Iframe"),r=null,s=null;return{get:f,getInfos:g,getData:i,setData:j,removeData:k,getDialog:l,open:h,on:p.on.bind(p),fire:p.fire.bind(p)}}),B("IframeManager",function(a,c,d){function e(a){return n[a]}function f(a,b){n[a]=b}function g(a){delete n[a]}function h(a,b,c){var d=a+"-"+b;n[d]=c,m.fire("open",[a,b,c])}function i(a,c,d){if("object"==typeof c){var e=c;c=a,a=e.id,d=[e]}var f=b.KISP.require("$")('iframe[data-sn="'+a+'"]').get(0);if(!f)throw new s("不存在 sn 为 "+a+" 的 iframe 页面");var g=f.contentWindow.KERP;if(g){var h=g.require("Iframe").fire(c,d);return h?h[h.length-1]:z}j(f).one("load",function(){var a=f.contentWindow.KERP;a&&a.require("Iframe").fire(c,d)})}var j=a("$"),k=a("MiniQuery"),l=k.require("Emitter"),m=new l,n={};return{open:h,getData:e,setData:f,removeData:g,on:m.on.bind(m),fire:i,sn$data:n}}),B("Loading",function(a,b,c){function d(a){this[i]="Loading-"+e.String.random();var b=a.container,c=a.text||k.text,d={container:b,selector:a.selector,text:c,rendered:!1};h.set(this,d)}var e=a("$"),f=a("Samples"),g=o.require("Mapper"),h=new g,i=g.getGuidKey(),j=f.get("Loading"),k={};return d.prototype={constructor:d,render:function(){var a=h.get(this),b=e.String.format(j,{text:a.text});e(a.container).html(b),a.rendered=!0},show:function(){var a=h.get(this);a.rendered||this.render();var b=a.selector;b&&e(b).hide(),e(a.container).show()},hide:function(){var a=h.get(this),b=a.selector;b&&e(b).show(),e(a.container).hide()}},e.Object.extend(d,{create:function(a){var b=new d(a);return b.show(),b},config:function(a){e.Object.extend(k,a)}})}),B("Login",function(a,c,e){function f(a){var c=h(),e=!(!c||!c.userID);if(!e&&a){var f=b.location.href,g=v.files,i="/"+g.master,j="/"+g.login;if(b===d&&f.indexOf(i)<0){var k=f.split("/html/");f=k[0]+j}else f=f.replace(i,j);b.location.href=f}return e}function g(){q.use(function(a){function b(a){var b=a.find('[data-id="ok"]'),e=b.html();b.html("登录中...").attr("disabled",!0);var f=a.find('[data-field="msg"]').hide();j({user:c.value,password:d.value},function(b,c){r.success("登录成功",2e3),a.close()},function(a,c,g){f.html(c).show(),b.html(e).attr("disabled",!1),d.value="",d.focus()},function(){f.html("网络繁忙，登录失败，请稍候再试!").show(),b.html(e).attr("disabled",!1),d.value="",d.focus()})}var c,d,e=h(),f=new a({width:240,height:100,skin:"login-box",title:"重新登录",content:m.String.format(u,{user:e?e.number||"":""}),okValue:"立即登录",ok:function(){return b(this),!1},onshow:function(){var a=this;c=this.find('[data-field="user"]').get(0),d=this.find('[data-field="password"]').get(0),m(c).on("keydown",function(c){13==c.keyCode&&b(a)}),m(d).on("keydown",function(c){13==c.keyCode&&b(a)})},onfocus:function(){k(function(){e?d.focus():c.focus()},100)}});f.showModal()})}function h(){var a=o.require("SessionStorage"),b=a.get(t);return b||null}function i(){var a=m.LocalStorage.get(t);return a||null}function j(a,b,c,d){var e=new n(v.api);e.get({action:v.actions.login,user:a.user,pwd:p.encrypt(a.password)}),e.on("success",function(a,c){var d=m.Object.extend({},a,{messageCount:a.messageCount||0,companyList:[]});m.SessionStorage.set(t,d),m.LocalStorage.set(t,d),b&&b(d,a,c)}),e.on({fail:c,error:d})}function l(a,b,c){var d=new n(v.api);d.on({fail:b,error:c}),d.get({action:v.actions.logout}),d.on("success",function(b,c){m.SessionStorage.remove(t);var d=h();a&&a(d,b,c)})}var m=a("$"),n=a("API"),p=a("MD5"),q=a("Dialog"),r=a("Tips"),s=a("Samples"),t="KERP.Login.user.F5F2BA55218E",u=s.get("Login"),v={};return{check:f,get:h,getLast:i,show:g,login:j,logout:l,config:function(a){m.Object.extend(v,a)}}}),B("Pager",function(a,c,d){function f(a,b,c,d){if("object"==typeof b){var e=b;b=e.from,c=e.to,d=e.more}var f=j.Array.pad(b,c+1),g=j.Array.keep(f,function(b,c){var d=b==a;return j.String.format(o.item,{no:b,active:d?"active":"","data-no":d?"":'data-no="'+b+'"'})}).join("");return d&&(g+=o.more),g}function g(a,b){return 10>=a?[{from:1,to:a,more:!1}]:3>=b?[{from:1,to:5,more:!0}]:5>=b?[{from:1,to:b+2,more:!0}]:b>=a-1?[{from:1,to:2,more:!0},{from:a-5,to:a,more:!1}]:[{from:1,to:2,more:!0},{from:b-2,to:b+2,more:b+2!=a}]}function h(a,b,c){if(1>=a)return a;if(b==a)return a-1;var d;return b>c?d=b+1:(d=b-1,1>d&&(d=2)),d}function i(a){function b(){var a=e.getElementById(o),b=a.value;r.to(b,!0)}var c=j.String.random().toLowerCase();this[n]="Pager-"+c;var d=a.container,f=a.current||1,g=a.size,h=a.total,i=u.ceil(h/g),l="ul-pager-"+c,o="txt-pager-"+c,p=new k.Event(this),q={ulId:l,txtId:o,container:d,current:f,size:g,count:i,hideIfLessThen:a.hideIfLessThen||0,emitter:p,last:0};m.set(this,q);var r=this;j.Array.each(["change","error"],function(b,c){var d=a[b];d&&r.on(b,d)});var s={no:"#"+l+" [data-no]",button:"#"+l+" [data-button]:not(.disabled)",txt:"#"+o};j(d).delegate(s.no,"click",function(a){var b=this,c=+b.getAttribute("data-no");r.to(c,!0)}).delegate(s.button,"click",function(a){var c=this,d=c.getAttribute("data-button");"to"==d?b():r[d](!0)}).delegate(s.txt,"keydown",function(a){13==a.keyCode&&b()})}var j=a("$"),k=a("MiniQuery"),l=k.require("Mapper"),m=new l,n=l.getGuidKey(),o=j.String.getTemplates(b.document.body.innerHTML,[{name:"ul",begin:"<!--Samples.Pager--!",end:"--Samples.Pager-->"},{name:"item",begin:"#--item.begin--#",end:"#--item.end--#",outer:"{items}"},{name:"more",begin:"#--more.begin--#",end:"#--more.end--#",outer:""}]);return i.prototype={constructor:i,render:function(){var a=m.get(this),b=a.count;if(b<a.hideIfLessThen)return void j(a.container).hide();var c=u.min(b,a.current),d=g(b,c),e=j.Array.keep(d,function(a,b){return f(c,a)}).join(""),i=h(b,c,a.last),k=j.String.format(o.ul,{"ul-id":a.ulId,"txt-id":a.txtId,current:c,count:b,toNo:i,"first-disabled-class":c==u.min(1,b)?"disabled":"","final-disabled-class":c==b?"disabled":"","jump-disabled-class":0==b?"disabled":"","txt-disabled":0==b?"disabled":"",items:e});j(a.container).html(k).show()},to:function(a,b){var c=m.get(this),d=c.emitter,e=/^\d+$/.test(a);if(!e)return void(b&&d.fire("error",["输入的页码必须是大于 0 的数字"]));a=parseInt(a);var f=c.count;return 1>a||a>f?void(b&&d.fire("error",["输入的页码值只能从 1 到 "+f])):(c.last=c.current,c.current=a,this.render(),void(b&&d.fire("change",[a])))},previous:function(a){var b=m.get(this);this.to(b.current-1,a)},next:function(a){var b=m.get(this);this.to(b.current+1,a)},first:function(a){this.to(1,a)},"final":function(a){var b=m.get(this);this.to(b.count,a)},refresh:function(a){var b=m.get(this);this.to(b.current,a)},on:function(){var a=m.get(this),b=a.emitter,c=[].slice.call(arguments,0);b.on.apply(b,c)},destroy:function(){var a=m.get(this);a.emitter.off();var b=a.container;j(b).html("").undelegate(),m.remove(this)}},j.Object.extend(i,{create:function(a){var b=new i(a);return b.render(),b}})}),B("Pagers",function(a,b,c){function d(a){var b=a.container,c=new g(h({},a,{container:b.simple}));c.on("change",function(a){d.to(a)});var d=new f(h({},a,{container:b.normal}));return d.on("change",function(a){c.to(a)}),c.render(),d.render(),[c,d]}var e=a("$"),f=a("Pager"),g=a("SimplePager"),h=e.Object.extend;return{create:d}}),B("Samples",function(a,c,d){function e(a){return a.replace(/\n/g,"").replace(/\s{2,}/g," ")}function f(a,b){var c="<!--Samples."+a+"--!",d="--Samples."+a+"-->",f=g.String.between(h,c,d);return b?(g.Array.each(b,function(a,b){if(a.trim){delete a.trim;var c=a.fn;c?a.fn=function(a){return a=c(a),a=e(a)}:a.fn=e}}),g.String.getTemplates(f,b)):f}var g=a("$"),h=b.document.body.innerHTML;return{get:f}}),B("SimplePager",function(a,b,c){function d(a){function b(a){var b=+a.value;b!=r.current?s.to(b,!0):s.render()}var c=e.String.random().toLowerCase(),d="-simple-pager-"+c;this[j]="SimplePager-"+c;var g=a.container||l.container,h=a.current||l.current,k=a.size||l.size,m=a.total,n=u.ceil(m/k),o="ul"+d,p="txt"+d,q=new f.Event(this),r={ulId:o,txtId:p,container:g,current:h,size:k,count:n,hideIfLessThen:a.hideIfLessThen||l.hideIfLessThen,emitter:q};i.set(this,r);var s=this;e.Array.each(["change","error"],function(b,c){var d=a[b];d&&s.on(b,d)});var t="#"+o+" [data-button]:not(.disabled)";e(g).delegate(t,"click",function(a){var b=this,c=b.getAttribute("data-button");s[c](!0)}),e(g).delegate("#"+p,{focusin:function(a){var b=this;b.value=r.current},focusout:function(a){b(this)},keydown:function(a){13==a.keyCode&&b(this)}})}var e=a("$"),f=a("MiniQuery"),g=f.require("Mapper"),h=a("Samples"),i=new g,j=g.getGuidKey(),k=h.get("SimplePager"),l={};return d.prototype={constructor:d,render:function(){var a=i.get(this),b=a.container,c=a.count;if(c<a.hideIfLessThen)return void e(b).hide();var d=u.min(c,a.current),f=e.String.format(k,{"ul-id":a.ulId,"txt-id":a.txtId,current:d,count:c,"first-disabled-class":d==u.min(1,c)?"disabled":"","final-disabled-class":d==c?"disabled":""});e(b).html(f).show()},to:function(a,b){var c=i.get(this),d=c.emitter,e=/^\d+$/.test(a);if(!e)return b&&d.fire("error",["输入的页码必须是大于 0 的数字"]),!1;a=parseInt(a);var f=c.count;return 1>a||a>f?(b&&d.fire("error",["输入的页码值只能从 1 到 "+f]),!1):(c.current=a,this.render(),b&&d.fire("change",[a]),!0)},focus:function(){var a=i.get(this);e(a.container).find("input").get(0).focus()},previous:function(a){var b=i.get(this);this.to(b.current-1,a)},next:function(a){var b=i.get(this);this.to(b.current+1,a)},first:function(a){this.to(1,a)},"final":function(a){var b=i.get(this);this.to(b.count,a)},refresh:function(a){var b=i.get(this);this.to(b.current,a)},on:function(){var a=i.get(this),b=a.emitter,c=[].slice.call(arguments,0);b.on.apply(b,c)},destroy:function(){var a=i.get(this);a.emitter.off();var b=a.container;e(b).html("").undelegate(),i.remove(this)}},e.Object.extend(d,{create:function(a){var b=new d(a);return b.render(),b},config:function(a){e.Object.extend(l,a)}})}),B("Tabs",function(a,b,c){function d(a){var b=this;this[j]="Tabs-"+e.String.random();var c=a.container,d=a.selector,f=a.activedClass,g=a.event,k=new h(this),l={container:c,selector:d,activedClass:f,eventName:g,activedIndex:-1,emitter:k};i.set(this,l),g&&e(c).delegate(d,g,function(f){var g,h=this;if("indexKey"in a)g=+h.getAttribute(a.indexKey);else{var i=e(c).find(d).toArray();g=e.Array.findIndex(i,function(a,b){return a===h})}k.fire("event",[g,h]),b.active(g,!0)});var m=a.change;m&&this.on("change",m);var n=a.current;"number"==typeof n&&n>=0&&this.active(n,!0)}var e=a("$"),f=a("MiniQuery"),g=f.require("Mapper"),h=f.require("Emitter"),i=new g,j=g.getGuidKey();return d.prototype={constructor:d,active:function(a,b){var c=i.get(this),d=c.activedIndex;if(a!=d||!b){this.reset(),c.activedIndex=a;var f=c.activedClass,g=e(c.container).find(c.selector).toArray(),h=g[a];e(h).addClass(f),b&&c.emitter.fire("change",[a,h])}},reset:function(){var a=i.get(this);e(a.container).find(a.selector).removeClass(a.activedClass),a.activedIndex=-1},remove:function(a){var b=i.get(this),c=b.activedIndex;return a==c?void this.reset():(c>a&&c--,void this.active(c,!1))},destroy:function(){var a=i.get(this),b=a.eventName;b&&e(a.container).undelegate(a.selector,b),a.emitter.off(),i.remove(this)},on:function(a,b){var c=i.get(this),d=c.emitter,e=[].slice.call(arguments,0);d.on.apply(d,e)},getActivedIndex:function(){var a=i.get(this);return a.activedIndex}},e.Object.extend(d,{create:function(a){return new d(a)}})}),B("Template",function(a,b,c){function d(a,b,c){if(g.Object.isPlain(a))return c=b,void g.Object.each(a,function(a,b){d(a,b,c)});if("string"==typeof a){var i=a;0==i.indexOf("#")&&(i=i.slice(1)),a=e.getElementById(i)}var j=f(a);b instanceof p?a.innerHTML=g.Array.keep(b,function(a,b){return c&&(a=c(a,b)),h(j,a)}).join(""):a.innerHTML=h(j,b)}function f(a){var b;"string"==typeof a?(b=a,0==b.indexOf("#")&&(b=b.slice(1)),a=e.getElementById(b)):(b=a.id,b||(b=a.getAttribute(j),b||(b=a.tagName.toLowerCase()+"-"+g.String.random(),a.setAttribute(j,b))));var c=i[b];return c||(c=g.String.between(a.innerHTML,"<!--","-->"),i[b]=c),c}var g=a("$"),h=g.String.format,i={},j="data-template-id-"+g.String.random(4).toLowerCase();return{fill:d,get:f}}),B("Tips",function(a,c,e){function f(a,c,e,f){function h(){var e=b.KERP.require("Tips");a?e.add(d,a,c):e.open(d)}if("object"==typeof c&&c){var i=c;c=i.text,e=i.duration,f=i.delay}clearTimeout(o),clearTimeout(p),f?p=k(h,f):h(),e&&(o=k(g,e))}function g(){clearTimeout(o),clearTimeout(p),b.KERP.require("Tips").close(d)}function h(a,b,c){f("success",a,b,c)}function i(a,b,c){f("info",a,b,c)}function j(a,b,c){f("warn",a,b,c)}function l(a,b,c){f("error",a,b,c)}function m(a,b,c){f("loading",a,b,c)}function n(){clearTimeout(p)}var o,p;return{show:f,hide:g,success:h,info:i,warn:j,error:l,loading:m,cancel:n,add:function(a,b,c){alert(b+":"+c)},open:function(){},close:function(){}}}),o.use("$"),A.expose({Module:!0,Cache:!0,Debug:!0,File:!0,Url:!0,Multitask:!0,Tree:!0,Seajs:!0,Proxy:!0,API:!0,Iframe:!0,IframeManager:!1,ButtonList:!0,CascadeMenus:!1,CascadeNavigator:!0,CascadePath:!1,CascadePicker:!0,Dialog:!0,Loading:!0,Login:!0,Pager:!0,SimplePager:!0,Tabs:!0,Template:!0,Tips:!0,Pagers:!0,NumberField:!0,DateTimePicker:!0});var D={require:function(a){return A.expose(a)?A.require(a):null},use:function(a,b){var c=D.require(a);if(!c)return void(b&&b(null));var d=c.use;d?d(b):b&&b(c)},config:C("Config").set,Cache:C("Cache"),Debug:C("Debug"),File:C("File"),Url:C("Url"),Proxy:C("Proxy"),API:C("API"),Pages:C("Pages"),CascadePicker:C("CascadePicker"),Dialog:C("Dialog"),Loading:C("Loading"),Login:C("Login"),Pager:C("Pager"),SimplePager:C("SimplePager"),Tabs:C("Tabs"),Template:C("Template"),Tips:C("Tips"),Pagers:C("Pagers")};"function"==typeof a.define&&(a.define.cmd||a.define.amd)?a.define(function(a){return D}):a.KERP=D}(this,top,parent,window,document,location,localStorage,sessionStorage,console,history,setTimeout,setInterval,KISP.require("$"),KISP.require("$"),KISP.require("MiniQuery"),Array,Boolean,Date,Error,Function,Math,Number,Object,RegExp,String);