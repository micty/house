!function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A){var B=function(){var a=z.require("Module"),b=new a({seperator:"/",crossover:!0,repeated:!1});return{define:b.define.bind(b),require:b.require.bind(b),expose:b.expose.bind(b),modules:b.modules.bind(b),tree:b.tree.bind(b),bind:function(a,c,d){return function(){var e=b.require(a),f=[].slice.call(arguments,0);d=d===!0?e:d,e[c].apply(d||null,f)}}}}(),C=B.define,D=B.require;C("$",function(){return z.use("jQuery"),y}),C("MiniQuery",function(){return z}),C("KISP",function(a,b,c){var d=null;b.exports=c={name:"house",version:"3.2.0",files:[],modules:B.modules,require:function(b){return B.expose(b)?a(b):null},invoke:function(a,b,d){var e=c.require(a);if(!e)throw new r("不存在该模块或该模块为非公开模块。");var f=e[b];if("function"!=typeof f)throw new r("模块 "+a+" 不存名为 "+b+" 的方法。");return f.apply(e,d)},create:function(a,b){var d=c.require(a);if("function"!=typeof d)return null;var e=arguments,f=e.length-1;return 0==f?new d:1==f?new d(b):2==f?new d(b,e[f]):3==f?new d(b,e[2],e[f]):4==f?new d(b,e[2],e[3],e[f]):5==f?new d(b,e[2],e[3],e[4],e[f]):null},proxy:B.bind("Proxy","response"),config:function(b,c){var d=a("Defaults"),e=arguments.length;return"string"==typeof b&&1==e?d.get(b):void d.set(b,c)},data:function(b,c){if(!d){var e=a("Config");d=new e}return"object"==typeof b?void d.set(b):1==arguments.length?d.get(b):void d.set(b,c)},alert:function(){var b=[].slice.call(arguments,0),c=a("Alert");c.show.apply(null,b)},confirm:function(b,c){var d=a("Confirm");d.show(b,c)},launch:function(b){var c=a("App"),d=new c(""),e=a("Config"),f=e.clone("App"),g=f.type;"standard"==g?d.render(b):d.launch(b)}}}),C("MD5",function(){function a(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var h=1732584193,i=-271733879,j=-1732584194,k=271733878,l=0;l<a.length;l+=16){var m=h,n=i,p=j,q=k;h=c(h,i,j,k,a[l+0],7,-680876936),k=c(k,h,i,j,a[l+1],12,-389564586),j=c(j,k,h,i,a[l+2],17,606105819),i=c(i,j,k,h,a[l+3],22,-1044525330),h=c(h,i,j,k,a[l+4],7,-176418897),k=c(k,h,i,j,a[l+5],12,1200080426),j=c(j,k,h,i,a[l+6],17,-1473231341),i=c(i,j,k,h,a[l+7],22,-45705983),h=c(h,i,j,k,a[l+8],7,1770035416),k=c(k,h,i,j,a[l+9],12,-1958414417),j=c(j,k,h,i,a[l+10],17,-42063),i=c(i,j,k,h,a[l+11],22,-1990404162),h=c(h,i,j,k,a[l+12],7,1804603682),k=c(k,h,i,j,a[l+13],12,-40341101),j=c(j,k,h,i,a[l+14],17,-1502002290),i=c(i,j,k,h,a[l+15],22,1236535329),h=d(h,i,j,k,a[l+1],5,-165796510),k=d(k,h,i,j,a[l+6],9,-1069501632),j=d(j,k,h,i,a[l+11],14,643717713),i=d(i,j,k,h,a[l+0],20,-373897302),h=d(h,i,j,k,a[l+5],5,-701558691),k=d(k,h,i,j,a[l+10],9,38016083),j=d(j,k,h,i,a[l+15],14,-660478335),i=d(i,j,k,h,a[l+4],20,-405537848),h=d(h,i,j,k,a[l+9],5,568446438),k=d(k,h,i,j,a[l+14],9,-1019803690),j=d(j,k,h,i,a[l+3],14,-187363961),i=d(i,j,k,h,a[l+8],20,1163531501),h=d(h,i,j,k,a[l+13],5,-1444681467),k=d(k,h,i,j,a[l+2],9,-51403784),j=d(j,k,h,i,a[l+7],14,1735328473),i=d(i,j,k,h,a[l+12],20,-1926607734),h=e(h,i,j,k,a[l+5],4,-378558),k=e(k,h,i,j,a[l+8],11,-2022574463),j=e(j,k,h,i,a[l+11],16,1839030562),i=e(i,j,k,h,a[l+14],23,-35309556),h=e(h,i,j,k,a[l+1],4,-1530992060),k=e(k,h,i,j,a[l+4],11,1272893353),j=e(j,k,h,i,a[l+7],16,-155497632),i=e(i,j,k,h,a[l+10],23,-1094730640),h=e(h,i,j,k,a[l+13],4,681279174),k=e(k,h,i,j,a[l+0],11,-358537222),j=e(j,k,h,i,a[l+3],16,-722521979),i=e(i,j,k,h,a[l+6],23,76029189),h=e(h,i,j,k,a[l+9],4,-640364487),k=e(k,h,i,j,a[l+12],11,-421815835),j=e(j,k,h,i,a[l+15],16,530742520),i=e(i,j,k,h,a[l+2],23,-995338651),h=f(h,i,j,k,a[l+0],6,-198630844),k=f(k,h,i,j,a[l+7],10,1126891415),j=f(j,k,h,i,a[l+14],15,-1416354905),i=f(i,j,k,h,a[l+5],21,-57434055),h=f(h,i,j,k,a[l+12],6,1700485571),k=f(k,h,i,j,a[l+3],10,-1894986606),j=f(j,k,h,i,a[l+10],15,-1051523),i=f(i,j,k,h,a[l+1],21,-2054922799),h=f(h,i,j,k,a[l+8],6,1873313359),k=f(k,h,i,j,a[l+15],10,-30611744),j=f(j,k,h,i,a[l+6],15,-1560198380),i=f(i,j,k,h,a[l+13],21,1309151649),h=f(h,i,j,k,a[l+4],6,-145523070),k=f(k,h,i,j,a[l+11],10,-1120210379),j=f(j,k,h,i,a[l+2],15,718787259),i=f(i,j,k,h,a[l+9],21,-343485551),h=g(h,m),i=g(i,n),j=g(j,p),k=g(k,q)}return o(h,i,j,k)}function b(a,b,c,d,e,f){return g(h(g(g(b,a),g(d,f)),e),c)}function c(a,c,d,e,f,g,h){return b(c&d|~c&e,a,c,f,g,h)}function d(a,c,d,e,f,g,h){return b(c&e|d&~e,a,c,f,g,h)}function e(a,c,d,e,f,g,h){return b(c^d^e,a,c,f,g,h)}function f(a,c,d,e,f,g,h){return b(d^(c|~e),a,c,f,g,h)}function g(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function h(a,b){return a<<b|a>>>32-b}function i(a){for(var b=o(),c=(1<<l)-1,d=0;d<a.length*l;d+=l)b[d>>5]|=(a.charCodeAt(d/l)&c)<<d%32;return b}function j(a){for(var b=k?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>d%4*8+4&15)+b.charAt(a[d>>2]>>d%4*8&15);return c}var k=0,l=8;return{encrypt:function(b){return arguments.length>1&&(b=o.prototype.slice.call(arguments,0).join("")),j(a(i(b),b.length*l))}}}),C("Config",function(a,b){function c(){f.setGuid(this);var a={name$config:{},name$formatted:{}};g.set(this,a)}var d=a("$"),e=a("MiniQuery"),f=e.require("Mapper"),g=new f;c.prototype={constructor:c,set:function(a,b){function c(a,b){var c;return a in f?(c=f[a],c=d.Object.isPlain(c)?d.Object.extend(c,b):f[a]=b):c=f[a]=b,h[a]=!1,c}var e=g.get(this),f=e.name$config,h=e.name$formatted;"object"==typeof a?d.Object.each(a,function(a,b){c(a,b)}):c(a,b)},get:function(a){var c=g.get(this),e=c.name$config,f=c.name$formatted;"object"==typeof a&&(a=a.id);var h=e[a];if(!d.Object.isPlain(h))return h;if("Url"==a)return h;var i=f[a];if(!i){var j=b.require("Url");h=j.format(h),e[a]=h,f[a]=!0}return h},clone:function(a){var b=this.get(a),c=[].slice.call(arguments,1);return c=[{},b].concat(c),d.Object.extendDeeply.apply(null,c)}};var h=a("Defaults");return d.Object.extend(c,{get:h.get,set:h.set,clone:h.clone})}),C("Defaults",function(a,b,c){function d(b){if(!g[b]){if(!f){var c=a("Config");f=new c}var d=a(b+".defaults"),h=a(b+".config"),i=e.Object.extend({},d,h);f.set(b,i),g[b]=!0}}var e=a("$"),f=null,g={};b.exports=c={set:function(a,b){"object"==typeof a?e.Object.each(a,function(a,b){d(a),f.set(a,b)}):(d(a),f.set(a,b))},get:function(a){return"object"==typeof a&&(a=a.id),d(a),f.get(a)},clone:function(a){var b=c.get(a),d=[].slice.call(arguments,1);return d=[{},b].concat(d),e.Object.extendDeeply.apply(null,d)}}}),C("Config/Url",function(a){function b(b){var d=a("Url");return c.Object.map(b,function(a,b){return"string"==typeof b?d.format(b):b instanceof o?c.Array.keep(b,function(a){return"string"==typeof a?d.format(a):"object"==typeof a?formatUrl(a):a},!0):b},!0)}var c=a("$");return{format:b}}),C("Edition",function(a){var b=(a("$"),"debug");return{get:function(){return b},set:function(a){b=a}}}),C("File",function(){function a(a){if(!a||"string"!=typeof a)return"";var b=a.split(".");if(b.length<2)return"";var c=b.slice(-1)[0];return"."+c}function b(a,b){return"string"!=typeof a||"string"!=typeof b?!1:a.slice(0-b.length).toLowerCase()==b.toLowerCase()}function c(a){return b(a,".js")}function d(a){return b(a,".css")}function e(a){return b(a,".json")}return{ext:a,is:b,isJs:c,isCss:d,isJson:e}}),C("Fn",function(a,b,c){var d=a("$");b.exports=c={delay:function(a,b,c){if(b){if(a===!1||null==a)return void b.apply(null,c);var e="number"==typeof a?a:d.Math.randomInt(a.min,a.max);return l(function(){b.apply(null,c)},e)}}}}),C("JSON",function(a,b,c){var e=d.JSON;b.exports=c={parse:function(a){try{return e.parse(a)}catch(b){}try{return a=a.replace(/^(\r\n)+/g,""),new s("return "+a)()}catch(b){}return null},stringify:function(a,b){return b===A&&(b=4),e.stringify(a,null,b)}}}),C("LocalStorage",function(a,b){function c(a,c){g.setGuid(this),c=h.clone(b.id,c);var d=c.name;if(!d)throw new r("请先配置 name 字段");var e=k[d];e||(e=k[d]={});var f={id:a,data:e[a],app:e};i.set(this,f)}var d=a("$"),e=a("MiniQuery"),f=e.require("LocalStorage"),g=e.require("Mapper"),h=a("Config"),i=new g,j="KISP.LocalStorage.B81138B047FC",k=f.get(j)||{};return c.prototype={constructor:c,set:function(a,b){var c=i.get(this),e=c.data,g=c.app,h=c.id;e||(e=g[h]=c.data={}),"object"==typeof a?d.Object.extend(e,a):e[a]=b,f.set(j,k)},get:function(a){var b=i.get(this),c=b.data;return c?0==arguments.length?c:c[a]:void 0},remove:function(a){var b=i.get(this),c=b.data;c&&(delete c[a],f.set(j,k))},clear:function(){var a=i.get(this),b=a.id,c=a.app;delete c[b],a.data=null,f.set(j,k)},each:function(a){var b=i.get(this),c=b.data;if(c&&a)for(var d in c)a(d,c[d])},length:function(){return this.keys().length},keys:function(){var a=i.get(this),b=a.data;if(!b)return[];if("function"==typeof v.keys)return v.keys(b);var c=[];for(var d in b)c.push(d);return c},key:function(a){return this.keys()[a]},length:function(){return this.keys().length}},c}),C("Mapper",function(a){var b=a("$"),c=a("MiniQuery"),d=c.require("Mapper"),e=new d;return{get:function(a){return e.get(a)},set:function(a,b){e.set(a,b)},setGuid:function(a,c){var e=c.id;e=e+"-"+b.String.random(),d.setGuid(a,e)},remove:function(a){e.remove(a)}}}),C("Module",function(a,b){var c=a("MiniQuery"),d=c.require("Module"),e=a("Config"),f=e.get(b),g=new d(f);return{define:g.define.bind(g),require:g.require.bind(g),modules:g.modules.bind(g),tree:g.tree.bind(g)}}),C("RandomId",function(a,b,c){var d=a("$");b.exports=c={get:function(){var a=[].slice.call(arguments);return a=d.Array.keep(a,function(a){return"number"==typeof a?d.String.random(a).toLowerCase():a}),a.join("")}}}),C("SessionStorage",function(a,b){function c(a,c){g.setGuid(this),c=h.clone(b.id,c);var d=c.name;if(!d)throw new r("请先配置 name 字段");var e=k[d];e||(e=k[d]={});var f={id:a,data:e[a],app:e};i.set(this,f)}var d=a("$"),e=a("MiniQuery"),f=e.require("SessionStorage"),g=e.require("Mapper"),h=a("Config"),i=new g,j="KISP.SessionStorage.B81138B047FC",k=f.get(j)||{};return c.prototype={constructor:c,set:function(a,b){var c=i.get(this),e=c.data,g=c.app,h=c.id;e||(e=g[h]=c.data={}),"object"==typeof a?d.Object.extend(e,a):e[a]=b,f.set(j,k)},get:function(a){var b=i.get(this),c=b.data;return c?0==arguments.length?c:c[a]:void 0},remove:function(a){var b=i.get(this),c=b.data;c&&(delete c[a],f.set(j,k))},clear:function(){var a=i.get(this),b=a.id,c=a.app;delete c[b],a.data=null,f.set(j,k)},each:function(a){var b=i.get(this),c=b.data;if(c&&a)for(var d in c)a(d,c[d])},length:function(){return this.keys().length},keys:function(){var a=i.get(this),b=a.data;if(!b)return[];if("function"==typeof v.keys)return v.keys(b);var c=[];for(var d in b)c.push(d);return c},key:function(a){return this.keys()[a]},length:function(){return this.keys().length}},c}),C("Style",function(a,b,c){function d(a){var b=typeof a;return"number"==b||/^\d+$/g.test(a)?a+"px":a}{var e=a("$"),f=a("MiniQuery"),g=(f.require("Mapper"),a("Config"),["border","border-radius","border-bottom-width","border-left-width","border-right-width","border-top-width","border-width","bottom","font-size","height","left","letter-spacing","line-height","margin","margin-bottom","margin-left","margin-right","margin-top","padding","padding-bottom","padding-left","padding-right","padding-top","right","top","width"]);g.concat([])}b.exports=c={pixelize:function(a,b){if("object"!=typeof a)return d(a);if(b instanceof o)e.Array.each(b,function(b){var c=a[b];null!=c&&(a[b]=d(c))});else{var c=a[b];null!=c&&(a[b]=d(c))}return a},checkUnit:function(a,b){return"string"==typeof a&&a.slice(0-b.length)==b},filter:function(a,b){a instanceof o||(a=[a]);var d=e.Array.map(a,function(a){return a&&"object"==typeof a?a=e.Object.filter(a,b):null});d=[{}].concat(d);var f=e.Object.extend.apply(null,d);return f=c.pixelize(f,g)},parse:function(){},stringify:function(a,b,c){if(!a)return"";"number"==typeof b&&(c=b,b=null);var d=[];return e.Object.each(a,function(a,e){if(e=b?b(a,e):e,e!==A){var f=a+": "+e;c&&(f=new o(c+1).join(" ")+f),d.push(f)}}),0==d.length?"":c?d.join(";\n")+";\n":d.join(";")+";"},parsePercent:function(a,b){return a=parseInt(a)/100,a*b+"px"}}}),C("Url",function(a,b,c){function d(){var d=a("Config"),e=d.get(b.id),f={},g=e.replacer;if(!g)return f;var h=g.root;if(h&&(f[h]=c.root()),h=g.edition){var i=a("Edition");f[h]=i.get()}return f}var e=a("$"),f="";b.exports=c={root:function(){if(!f){var c=a("Config"),d=c.get(b.id);f=d.root,"function"==typeof f&&(f=f())}return f},checkFull:function(a){return"string"!=typeof a?!1:0==a.indexOf("http://")||0==a.indexOf("https://")},format:function(a,b){if("object"!=typeof b){var c=[].slice.call(arguments,1);b=e.Array.toObject(c),delete b.length}var f=d();return b=b?e.Object.extend(b,f):f,e.String.format(a,b)}}}),C("API",function(a,b){function c(a,c){function d(a,b,d){a=m.status=a||m.status,b=m.args=b||m.args,d=d||m.emitter,h.delay(c.delay,function(){m.xhr=null,d.fire("response",b),"success"==a?d.fire("code",j,b):"fail"==a&&d.fire("code",b[0],b);var c=b.slice(-1)[0];c&&d.fire("status",c.status,b),d.fire(a,b),d.fire("done",b)})}a=a||"",c=g.clone(b.id,c),i.setGuid(this,b);var e=new f(this),j=c.successCode,k=c.proxy;k&&"object"==typeof k&&(k=k[a]),k===!0&&(k=a+".js");var l={name:a,data:c.data,query:c.query,url:c.url,prefix:c.prefix,ext:c.ext,random:c.random,successCode:j,field:c.field,proxy:k,serialize:c.serialize,timeout:c.timeout,success:function(a,b,c){d("success",[a,b,c])},fail:function(a,b,c,e){d("fail",[a,b,c,e])},error:function(a){return m.aborted?void(m.aborted=!1):void d("error",[a])},ontimeout:function(a){d("timeout",[a])}},m={ajax:l,status:"",args:[],emitter:e,xhr:null,aborted:!1,fireEvent:d};i.set(this,m)}var d=a("$"),e=a("MiniQuery"),f=e.require("Emitter"),g=a("Config"),h=a("Fn"),i=a("Mapper");return c.prototype={constructor:c,get:function(a){var c=i.get(this),e=c.emitter;c.aborted=!1;var f=d.Object.extend({},c.ajax);a&&(f.data=a),a=f.data,e.fire("request","get",[a]),e.fire("request",["get",a]);var g=b.require("Ajax");return c.xhr=g.get(f),this},post:function(a,c){var e=i.get(this),f=e.emitter,g=e.ajax;e.aborted=!1;var h=d.Object.extend({},g,{data:a||g.data,query:c||g.query});a=h.data,c=h.query,f.fire("request","post",[a,c]),f.fire("request",["post",a,c]);var j=b.require("Ajax");return e.xhr=j.post(h),this},abort:function(){var a=i.get(this),b=a.xhr;b&&(a.aborted=!0,b.abort(),a.emitter.fire("abort"))},on:function(){var a=i.get(this),b=a.emitter,c=[].slice.call(arguments,0);b.on.apply(b,c);var d=a.status;if(d){var e=new f(this);e.on.apply(e,c),a.fireEvent(d,a.args,e),e.destroy()}return this},off:function(){var a=i.get(this),b=a.emitter,c=[].slice.call(arguments,0);return b.off.apply(b,c),this},destroy:function(){var a=i.get(this),b=a.emitter;b.destroy(),i.remove(this)}},c}),C("API/Ajax",function(a){function b(b,e){var f=e.proxy;if(f){var g=a("Proxy");return g.request(f,e),null}var h=[e.url,e.prefix,e.name,e.ext].join(""),i=e.data||null;if(i){var j=e.serialize;i=c.Object.map(i,function(a,b){return"object"==typeof b&&b?j(a,b):b})}var k=d.require("Url"),m=e.random;if(m&&(m="rd_"+c.String.random(16),h=k.addQueryString(h,m,"")),"post"==b){var n=e.query;n&&(h=k.addQueryString(h,n)),i&&(i=c.Object.toQueryString(i))}else i&&(h=k.addQueryString(h,i),i=null);var o=!1,p=null,q=e.timeout||0;q>0&&(p=l(function(){o=!0,r.abort();var a=e.ontimeout;a&&a(r)},q));var r=new XMLHttpRequest;return r.open(b,h,!0),r.onreadystatechange=function(){if(!o&&4==r.readyState){clearTimeout(p);var b=e.successCode,c=e.error;if(200!=r.status)return void(c&&c(r));var d=a("JSON"),f=d.parse(r.responseText);if(!f)return void(c&&c(r));var g=e.field,h=f[g.code];if(h==b){var i=e.success,j=g.data in f?f[g.data]:{};i&&i(j,f,r)}else{var k=e.fail;k&&k(h,f[g.msg],f,r)}}},"post"==b&&r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(i),r}var c=a("$"),d=a("MiniQuery");return{get:function(a){return b("get",a)},post:function(a){return b("post",a)}}}),C("Proxy",function(a,b,c){function d(a){var c=i.get(b.id),d=c.delay,e=[].slice.call(arguments,1);j.delay(d,a,e)}function e(a,c){var d=b.require("Url"),e=d.get(a),f=h.require("Script");f.load(e,function(){var a=k;k=null,"function"==typeof a&&(a=a(c.data,c)),g(a,c)})}function f(c,e){var f=b.require("Url"),h=f.get(c),i=new XMLHttpRequest;i.open("get",h,!0),i.onreadystatechange=function(){if(4==i.readyState){if(200!=i.status)return void d(e.error);var b=a("JSON"),c=b.parse(i.responseText);g(c,e)}},i.send(null)}function g(a,b){if(!a)return void d(b.error);var c=b.successCode,e=b.field,f=a[e.code];if(f==c){var g=a[e.data]||{};d(b.success,g,a)}else{var h=a[e.msg]||"";d(b.fail,f,h,a)}}var h=(a("$"),a("MiniQuery")),i=a("Config"),j=a("Fn"),k=null;b.exports=c={request:function(b,c){var d=a("File");if(d.isJs(b))return void e(b,c);if(d.isJson(b))return void f(b,c);throw new r("不支持参数 file 的文件类型: "+b)},response:function(a){k=a}}}),C("Proxy/Url",function(a,b){function c(a){if(g.checkFull(a))return a;var c=e.get(b.parent.id),d=c.base;if(g.checkFull(d))return d+a;var f=g.root();return"/"!=a.slice(0,1)&&(f+=d),f+a}var d=(a("$"),a("MiniQuery")),e=a("Config"),f=d.require("Url"),g=a("Url");return{get:function(a){return a=c(a),f.randomQueryString(a)}}}),C("App",function(a,b){function c(a,c){f.setGuid(this),c=g.clone(b.id,c);var d={name:a,mask:c.mask,animation:c.animation};h.set(this,d)}var d=(a("$"),a("MiniQuery")),f=d.require("Mapper"),g=a("Config"),h=new f;return c.prototype={constructor:c,launch:function(b){var c=a("jquery-plugin/touch")||a("$"),d=a("MiniQuery"),e=a("KISP"),f=a("Module"),g=f.define;g("$",function(){return c}),g("MiniQuery",function(){return d}),g("KISP",function(){return e});var i=h.get(this),j=i.name;g(j,b),f.require(j)},render:function(c){var d=h.get(this),f=b.require("Nav");if(!d.animation)return void this.launch(function(a,b){var g=f.create(d.mask);g.on("back",function(a,c){e.activeElement.blur(),a=b.require(a),c=b.require(c),a.hide(),c.show()}),g.on("before-to",function(a){a=b.require(a),a.hide()}),g.on("to",function(a){var c=[].slice.call(arguments,1),d=b.require(a);d.render.apply(d,c)}),c&&c(a,b,g)});var g=a("Mask"),i=b.require("Transition");this.launch(function(a,b){var d={},h=i.getEventName(),j=f.create(),k=new g;k.render(),j.on("back",function(a,c){e.activeElement.blur(),c=b.require(c),c.show(),a=b.require(a),a.$.removeClass("Forward").addClass("Back"),c.$.css({"z-index":1}),a.$.css({"z-index":3}),k.$.removeClass("BeforeForward Forward Back"),k.$.addClass("BeforeBack"),k.$.show(),l(function(){k.$.addClass("Back")},50)}),j.on("before-to",function(a,c){var e=c;a=b.require(a),c=b.require(c),a.$.css({"z-index":1}),c.$.css({"z-index":3}),c.$.addClass("BeforeForward"),c.$.removeClass("Back"),c.$.show(),k.$.removeClass("Back BeforeBack Forward"),k.$.addClass("BeforeForward"),k.$.show(),l(function(){k.$.addClass("Forward"),c.$.addClass("Forward")},50);var f=d[e];f||(c.$.on(h,function(){c.$.hasClass("Forward")?a.hide():c.$.hasClass("Back")&&c.hide(),k.$.hide()}),d[e]=!0)}),j.on("to",function(a){var c=[].slice.call(arguments,1),d=b.require(a);d.render.apply(d,c)}),c&&c(a,b,j)})}},c}),C("App/Nav",function(a){function b(b){function d(){h.show()}var e=a("Navigator"),f=new e({hash:function(a){return[a,c.String.random(8)].join("-")}});if(b){var g=a("Mask"),h=new g({opacity:b.opacity,duration:b.duration,"z-index":b["z-index"]});h.render(),f.on({"before-to":d,back:d})}var i=f.to;return f.to=function(a,b){var c=[].slice.call(arguments);"string"==typeof a?(b=a,a=!1):c=c.slice(1),a?l(function(){i.apply(f,c)},a):i.apply(f,c)},f}var c=a("$");return{create:b}}),C("App/Transition",function(a){function b(){if(d)return d;var a=e.createElement("div");for(var b in c)if(a.style[b]!==A)return d=c[b]}var c=(a("$"),{transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"}),d="";return{getEventName:b}}),C("Alert",function(a,b){function c(a,c,f,g){if("object"==typeof a){var h=b.require("Sample");a=n.stringify(a,null,4),a=d.String.format(h,{text:a})}var i=[].slice.call(arguments,1),j=d.Array.findIndex(i,function(a){return"function"==typeof a});j>=0?(g=i[j],i=i.slice(0,j)):g=null,i=[a].concat(i),a=d.String.format.apply(null,i),e.add(a,g)}var d=a("$"),e=b.require("Dialog");return{show:c}}),C("Alert/Dialog",function(a){function b(){var b=h.clone("Alert"),c=a("Dialog"),f=new c({cssClass:"Alert","volatile":b["volatile"],mask:b.mask,autoClosed:b.autoClosed,width:b.width,"z-index":b["z-index"],buttons:[{name:"ok",text:b.button}]});return f.on("button","ok",function(){var a=f.data("fn");a&&a()}),f.on({show:function(){j=!0},hide:function(){j=!1;var a=k.shift();a&&d(a.text,a.fn)}}),g(e).on("keyup",function(a){if(13==a.keyCode){f.hide();var b=f.data("fn");b&&b()}}),f}function c(a){a=x(a);var b=g.String.getByteLength(a),c=t.max(b,125),d=e.documentElement.clientHeight;return c>=.8*d&&(c="80%"),c}function d(a,d){var e=c(a);i=i||b(),i.data("fn",d),i.set("text",a),i.set("height",e),i.show()}function f(a,b){return j?void k.push({text:a,fn:b}):void d(a,b)}var g=a("$"),h=a("Config"),i=null,j=!1,k=[];return{add:f}}),C("Alert/Sample",['<pre class="JSON">{text}</pre>'].join("\n")),C("Confirm",function(a){function b(){if(d)return d;var b=a("Dialog");return d=new b({autoClose:!0,height:140,"z-index":99999,buttons:[{text:"取消"},{text:"确定",name:"ok",color:"red"}]}),d.on("button","ok",function(){var a=d.data("fn");a&&a()}),d}function c(a,c){d=b(),d.data("fn",c),d.set("text",a),d.show()}var d=null;return{show:c}}),C("Dialog",function(a,b){function c(a){n.setGuid(this,b),a=h.clone(b.id,a);var c=new g(this),f=a.cssClass;f instanceof o&&(f=f.join(" "));var l=a.buttons,m=a.eventName,p=a.prefix,q=a.suffix,r={id:i.get(p,q),articleId:i.get(p,"article-",q),contentId:i.get(p,"content-",q),footerId:i.get(p,"footer-",q),div:null,scrollable:a.scrollable,scroller:null,scrollerConfig:a.scroller,eventName:m,title:a.title,text:a.text,buttons:l,samples:j.get(a.sample),emitter:c,mask:a.mask,masker:null,layer:null,cssClass:f,style:k.get(a),autoClosed:a.autoClosed,visible:!1,"volatile":a["volatile"],zIndex:a["z-index"],data:{}};n.set(this,r),l&&l.length>0&&e.Array.each(l,function(a,b){var d=a.fn;if(d){var e=a.name||x(b);c.on(m,"button",e,d),c.on("button",e,d)}});var s=e.Object.filter(a,["width","height"]);e(d).on("resize",function(){var a=k.get(s);e(r.div).css(a)})}var e=a("$"),f=a("MiniQuery"),g=f.require("Emitter"),h=a("Config"),i=a("RandomId"),j=b.require("Sample"),k=b.require("Style"),m=b.require("Renderer"),n=a("Mapper");return c.prototype={constructor:c,$:null,render:function(){var b=n.get(this),c=b.div;if(!c){c=b.div=m.render(b,this),e(c).hide();var d=a("Mask"),f=b.zIndex;if(b.masker=new d({"z-index":f-1}),b["volatile"]){var g=this;b.masker.on("click",function(){g.hide()})}b.layer=new d({opacity:0,"z-index":f+1})}},show:function(b){var c=n.get(this);this.render();var d=a("Mask");b=d.filter(c.mask,b),b?c.masker.show(b):masker.hide(),c.layer.show({duration:200}),e(c.div).css(c.style),l(function(){e(c.div).show()},0),c.visible=!0,c.emitter.fire("show")},hide:function(){var a=n.get(this),b=a.div;if(b&&a.visible){var c=a.masker;c&&c.hide(),e(b).hide(),a.visible=!1,a.emitter.fire("hide")}},remove:function(){var a=n.get(this),b=a.div;if(b){var c=a.masker;c&&c.remove();var d=a.layer;d&&d.remove(),a.div=null,a.masker=null,a.layer=null,a.visible=!1,e(b).off(),b.parentNode.removeChild(b),a.emitter.fire("remove")}},on:function(){var a=n.get(this),b=a.emitter,c=[].slice.call(arguments,0);b.on.apply(b,c)},destroy:function(){var a=n.get(this);if(!a)throw new r("该实例已给销毁，无法再次调用 destroy 方法。");var b=a.emitter,c=a.scroller;this.remove(),b.destroy(),c&&c.destroy(),n.remove(this)},set:function(a,b){var c=n.get(this),d=c.scroller;switch(this.render(),a){case"text":e("#"+c.contentId).html(b),d&&d.refresh(200);break;case"height":case"width":var f={};f[a]=b,f=k.get(f),e.Object.extend(c.style,f),e(c.div).css(f),d&&d.refresh(300);break;default:throw new r("目前不支持设置属性: "+a)}},data:function(a,b){var c=n.get(this),d=c.data,f=arguments.length;return 0==f?d:e.Object.isPlain(a)?(e.Object.extend(d,a),a):1==f?d[a]:(d[a]=b,b)}},c}),C("Dialog/Sample/iOS",["#--div.begin--#",'<div id="{id}" class="KISP Dialog {cssClass}" style="{style}">',"","    #--header.begin--#",'    <header style="{style}">',"        {title}","    </header>","    #--header.end--#","",'    <article id="{article-id}" class="{no-header} {no-footer}">','        <div id="{content-id}">{text}</div>',"    </article>","","    #--footer.begin--#",'    <footer id="{id}" class="buttons-{count}">',"        #--button.begin--#",'        <span data-index="{index}" style="{style}">{text}</span>',"        #--button.end--#","    </footer>","    #--footer.end--#","</div>","#--div.end--#"].join("\n")),C("Dialog/Renderer",function(a){function b(a){if(!a)return"";var b=f.filter(a,["border-bottom","color","font-size","font-weight","width"]);return b=f.stringify(b)}function c(c,g){function h(){var a=this,b=+a.getAttribute("data-index"),d=i[b],e=d.name||x(b);j.fire("click","button",e,[d,b]),j.fire("click","button",[d,b]),j.fire("button",e,[d,b]),j.fire("button",[d,b]);var f=d.autoClosed;f===A&&(f=c.autoClosed),f&&g.hide()}var i=c.buttons||[],j=c.emitter,k=c.id,l=c.articleId,m=c.footerId,n=c.style,o=c.samples,p=c.title;p&&"object"!=typeof p&&(p={text:p||""});var q=d.String.format(o.div,{id:k,"article-id":l,"content-id":c.contentId,cssClass:c.cssClass,style:f.stringify(n),text:c.text,"text-height":parseInt(n.height)-88-2,"no-header":p?"":"no-header","no-footer":i.length>0?"":"no-footer",header:function(a){return a?d.String.format(o.header,{style:b(a),title:a.text}):""}(p),footer:function(a){var c=a.length;return c?d.String.format(o.footer,{id:m,count:c,buttons:d.Array.keep(a,function(c,e){return"string"==typeof c&&(a[e]=c={text:c}),d.String.format(o.button,{index:e,text:c.text,style:b(c)})}).join("")}):""}(i)});d(e.body).prepend(q);var r=c.eventName,s=d("#"+l);if("touch"==r?s.touch(function(){j.fire("touch-main")}):s.on(r,function(){j.fire(r+"-main")}),c.scrollable){var t=a("Scroller"),u=new t(s.get(0),c.scrollerConfig);c.scroller=u}var v=d("#"+m);i.length>0&&("touch"==r?v.touch("[data-index]",h,"pressed"):(v.on(r,"[data-index]",h),v.on("mousedown","[data-index]",function(){var a=this;d(a).addClass("pressed")}),v.on("mouseup mouseout","[data-index]",function(){var a=this;d(a).removeClass("pressed")})));var w=e.getElementById(k);return g.$=d(w),w}var d=a("$"),f=a("Style");return{render:c}}),C("Dialog/Sample",function(a,b){function c(a){return a.replace(/\n|\r|\r\n/g," ").replace(/\s+/g," ")}function d(d){var f=a(b,d),g=e.String.getTemplates(f,[{name:"div",begin:"#--div.begin--#",end:"#--div.end--#",fn:c},{name:"header",begin:"#--header.begin--#",end:"#--header.end--#",outer:"{header}",fn:c},{name:"footer",begin:"#--footer.begin--#",end:"#--footer.end--#",outer:"{footer}",fn:c},{name:"button",begin:"#--button.begin--#",end:"#--button.end--#",outer:"{buttons}",fn:c}]);return g}var e=a("$");return{get:d}}),C("Dialog/Style",function(a){function b(a){var b=typeof a;return"number"==b?0-a/2+"px":"string"==b&&"px"==a.slice(-2)?(a=parseInt(a),0-a/2+"px"):void 0}function c(a){var c=d.filter(a,["background","border","border-radius","height","width","z-index","position"]);if("width"in c){var f=c.width;if("number"!=typeof f){var g=e.documentElement.clientWidth;d.checkUnit(f,"%")?c.width=d.parsePercent(f,g):f||(c.width=.8*g+"px")}}if("height"in c){var h=c.height;if("number"!=typeof h){var i=e.documentElement.clientHeight;d.checkUnit(h,"%")?c.height=d.parsePercent(h,i):h||(c.height=.8*i+"px")}}var j=b(c.width);return j&&(c["margin-left"]=j),j=b(c.height),j&&(c["margin-top"]=j),c}var d=(a("$"),a("Style"));return{get:c}}),C("Loading",function(a,b){function c(b){var c=s.get(this),d=c.id,g=c.sample,h=a("Style"),i=f.String.format(g,{id:d,"text-id":c.textId,text:c.text,style:h.stringify(b),cssClass:c.cssClass}),j=c.container;c.append?f(j).append(i):f(j).prepend(i);var k=e.getElementById(d);return c.div=k,k}function d(a){h.setGuid(this);var c=a?r[a.presetting]:null;a=k.clone(b.id,c,a);var d=new i(this),e=a.cssClass;e instanceof o&&(e=e.join(" "));var g=a.text;g||0===g||(e+=" NoText"),e=f.Array.keep(e.split(" "),function(a){return"same-line"==a?(j.warn('类名 "same-line" 已过时，请使用 "SameLine"'),"SameLine"):a}).join(" ");var l=a.prefix,q=a.suffix,t={id:m.get(l,q),textId:m.get(l,"text-",q),container:a.container,prepend:a.prepend,div:null,sample:n.get(a.sample),text:g,emitter:d,mask:a.mask,masker:null,style:p.get(a),showTime:0,cssClass:e,append:a.append};s.set(this,t)}var f=a("$"),g=a("MiniQuery"),h=g.require("Mapper"),i=g.require("Emitter"),k=a("Config"),m=a("RandomId"),n=b.require("Sample"),p=b.require("Style"),r=b.require("Presettings"),s=new h;return d.prototype={constructor:d,render:function(){},show:function(b,d){"object"==typeof b&&(d=b,b=d.text),d=d||{};var g=s.get(this),h=g.div,i=p.get(g.style,d);h||(h=c.call(this,i)),f(h).css(i);var j=a("Mask"),k=j.filter(g.mask,d.mask),m=g.masker;k?(m||(m=g.masker=new j({container:g.container})),m.show(k)):m&&m.hide(),b!==A&&b!=g.text&&(e.getElementById(g.textId).innerHTML=b,g.text=b),g.showTime=q.now(),f(h).show(),g.emitter.fire("show");var n=d.duration;if(n){var o=this;l(function(){o.hide()},n)}},hide:function(a){function b(){var a=c.masker;a&&a.hide(),c.showTime=0,f(d).hide(),c.emitter.fire("hide")}var c=s.get(this),d=c.div;if(d){if(!a)return void b();var e=q.now(),g=c.showTime,h=e-g,i=a-h;i>0?l(b,i):b()}},remove:function(){var a=s.get(this),b=a.div;if(b){var c=a.masker;c&&c.remove(),a.div=null,a.masker=null,a.hasBind=!1,f(b).off(),e.body.removeChild(b),a.emitter.fire("remove")}},on:function(){var a=s.get(this),b=a.emitter,c=[].slice.call(arguments,0);b.on.apply(b,c)},destroy:function(){var a=s.get(this),b=a.emitter;this.remove(),b.destroy(),s.remove(this)}},d}),C("Loading/Sample/iOS",['<div id="{id}" class="KISP Loading-iOS {cssClass}" style="{style}">','    <div class="Main">','        <div class="Item-0"></div>','        <div class="Item-1"></div>','        <div class="Item-2"></div>','        <div class="Item-3"></div>','        <div class="Item-4"></div>','        <div class="Item-5"></div>','        <div class="Item-6"></div>','        <div class="Item-7"></div>','        <div class="Item-8"></div>','        <div class="Item-9"></div>','        <div class="Item-10"></div>','        <div class="Item-11"></div>',"    </div>",'    <span id="{text-id}" class="Text">{text}</span>',"</div>"].join("\n")),C("Loading/Presettings",{fullscreen:{width:"100%",height:"100%",top:0,left:0,bottom:0,right:0,"font-size":15,"margin-top":0,"margin-left":0,"margin-right":0,"margin-bottom":0,"border-radius":0},"scroller.pulldown":{sample:"iOS",cssClass:"SameLine",text:"加载中...",background:"none",color:"#000",height:26,width:"100%",left:0,top:0,bottom:"initial",right:"initial","font-size":15,"margin-top":0,"border-radius":0},"scroller.pullup":{sample:"iOS",cssClass:"SameLine",text:"加载中...",background:"none",color:"#000",height:26,width:"100%",top:"initial",right:"initial",left:0,bottom:0,"font-size":15,"margin-top":0,"border-radius":0}}),C("Loading/Sample",function(a,b){function c(c){var e=d[c];return e?e:(e=a(b,c),d[c]=e,e)}var d={};return{get:c}}),C("Loading/Style",function(a){function b(a){var b=typeof a;return"number"==b?0-a/2+"px":"string"==b&&"px"==a.slice(-2)?(a=parseInt(a),0-a/2+"px"):"0px"}function c(){var a=[].slice.call(arguments),c=d.filter(a,["background","border-radius","bottom","color","font-size","height","left","margin-top","right","top","width","z-index","position"]);return c["margin-left"]=b(c.width),c["margin-top"]===A&&(c["margin-top"]=b(c.height)),c}var d=(a("$"),a("Style"));return{get:c}}),C("Mask",function(a,b){function c(a){f.setGuid(this),a=h.clone(b.id,a);var c=a.prefix,d=a.suffix,e=new g(this),l={id:i.get(c,d),div:null,sample:j,"volatile":a["volatile"],emitter:e,style:k.get(a),showTime:0,container:a.container,duration:a.duration,append:a.append,eventName:a.eventName};m.set(this,l)}var d=a("$"),e=a("MiniQuery"),f=e.require("Mapper"),g=e.require("Emitter"),h=a("Config"),i=a("RandomId"),j=b.require("Sample"),k=b.require("Style"),m=new f;return c.prototype={constructor:c,$:null,render:function(){var a=m.get(this);if(!a.div){var b=a.id,c=a.sample,e=a.eventName,f=d.String.format(c,{id:b}),g=d(a.container);a.append?g.append(f):g.prepend(f);
var h=a.div=d("#"+b);this.$=h;var i=k.get(a.style);if(h.css(i),a["volatile"]){var j=this,n=function(){j.hide();var a=h.css("opacity");j.show({opacity:0}),l(function(){h.css("opacity",a).hide()},200)};"touch"==e?h.touch(n):h.on(e,n)}}},show:function(a){"number"==typeof a&&(a={duration:a});var b=m.get(this),c=b.emitter;this.render();var d=b.div;if(a){var e=k.get(b.style,a);d.css(e)}b.showTime=new q,d.show(),c.fire("show");var f=a&&"duration"in a?a.duration:b.duration;if(f){var g=this;l(function(){g.hide()},f)}},hide:function(a){function b(){c.showTime=0,d.hide(),c.emitter.fire("hide")}var c=m.get(this),d=c.div;if(d){if(!a)return void b();var e=new q,f=c.showTime,g=e-f,h=a-g;h>0&&l(b,h)}},remove:function(){var a=m.get(this),b=a.div;b&&(a.div=null,b.off(),b=b.get(0),b.parentNode.removeChild(b),a.emitter.fire("remove"))},on:function(){var a=m.get(this),b=a.emitter,c=[].slice.call(arguments,0);b.on.apply(b,c)},destroy:function(){var a=m.get(this),b=a.emitter;this.remove(),b.destroy(),m.remove(this)}},d.Object.extend(c,{filter:function(a,b){"number"==typeof a&&(a={opacity:a}),"number"==typeof b&&(b={opacity:b});var c=typeof a;return"object"==c&&"object"==typeof b?d.Object.extend({},a,b):b===!1?null:b===!0?a&&"object"==c?a:{}:b===A?"object"==c?a:a?{}:null:"object"==typeof b?b:b?{}:null}}),c}),C("Mask/Sample",['<div id="{id}" class="KISP Mask" style="display: none;"></div>'].join("\n")),C("Mask/Style",function(a){function b(){var a=[].slice.call(arguments),b=c.filter(a,["opacity","top","bottom","background","z-index","position"]);return b}var c=(a("$"),a("Style"));return{get:b}}),C("Toast",function(a,b){function c(a){g.setGuid(this),a=i.clone(b.id,a);var c=new h(this),d=a.cssClass;d instanceof o&&(d=d.join(" "));var e=a.text;d+=e||0===e?" HasText":" NoText";var f=a.icon;d+=f?" HasIcon":" NoIcon";var k=a.prefix,l=a.suffix,q={id:j.get(k,l),icon:f,iconId:j.get(k,"icon-",l),textId:j.get(k,"text-",l),div:null,sample:m.get(a.sample),text:e,emitter:c,mask:a.mask,masker:null,style:n.get(a),showTime:0,cssClass:d,duration:a.duration,container:a.container,append:a.append};p.set(this,q)}var d=a("$"),f=a("MiniQuery"),g=f.require("Mapper"),h=f.require("Emitter"),i=a("Config"),j=a("RandomId"),k=b.require("Renderer"),m=b.require("Sample"),n=b.require("Style"),p=new g;return c.prototype={constructor:c,show:function(b,c){var e=typeof b;"object"==e&&(c=b,b=c.text),c=c||{};var f=p.get(this),g=f.div,h=n.get(f.style,c);g||(g=k.render(f,h)),d(g).css(h);var i=a("Mask"),j=i.filter(f.mask,c.mask),m=f.masker;if(j?(m||(m=new i,f.masker=m),m.show(j)):m&&m.hide(),b!==A&&b!=f.text&&(d("#"+f.textId).html(b),f.text=b,d(g).removeClass("NoText").addClass("HasText")),"icon"in c){var o=c.icon;o?(d(g).removeClass("NoIcon").addClass("HasIcon"),o!=f.icon&&(d("#"+f.iconId).removeClass("fa-"+f.icon).addClass("fa-"+o),f.icon=o)):d(g).removeClass("HasIcon").addClass("NoIcon")}f.showTime=new q,d(g).show(),f.emitter.fire("show");var r="duration"in c?c.duration:f.duration;if(r){var s=this;l(function(){s.hide()},r)}},hide:function(a){function b(){var a=c.masker;a&&a.hide(),c.showTime=0,d(e).hide(),c.emitter.fire("hide")}var c=p.get(this),e=c.div;if(e){if(!a)return void b();var f=new q,g=c.showTime,h=f-g,i=a-h;i>0?l(b,i):b()}},remove:function(){var a=p.get(this),b=a.div;if(b){var c=a.masker;c&&c.remove(),a.div=null,a.masker=null,a.hasBind=!1,d(b).off(),e.body.removeChild(b),a.emitter.fire("remove")}},on:function(){var a=p.get(this),b=a.emitter,c=[].slice.call(arguments,0);b.on.apply(b,c)},destroy:function(){var a=p.get(this),b=a.emitter;this.remove(),b.destroy(),p.remove(this)}},c}),C("Toast/Sample/font-awesome",['<div id="{id}" class="KISP Toast-font-awesome {cssClass}">',"    <div>",'        <i id="{icon-id}" class="fa fa-{icon}"></i>',"    </div>",'    <span id="{text-id}" class="Text">{text}</span>',"</div>"].join("\n")),C("Toast/Renderer",function(a){function b(b,d){var f=a("Style"),g=b.id,h=b.sample,i=c.String.format(h,{id:g,icon:b.icon,"icon-id":b.iconId,"text-id":b.textId,text:b.text,style:f.stringify(d),cssClass:b.cssClass}),j=b.container;b.append?c(j).append(i):c(j).prepend(i);var k=e.getElementById(g);return b.div=k,k}var c=a("$");return{render:b}}),C("Toast/Sample",function(a,b){function c(c){var e=d[c];return e?e:(e=a(b,c),d[c]=e,e)}var d={};return{get:c}}),C("Toast/Style",function(a){function b(a){var b=typeof a;return"number"==b?0-a/2+"px":"string"==b&&"px"==a.slice(-2)?(a=parseInt(a),0-a/2+"px"):void 0}function c(){var a=[].slice.call(arguments),c=d.filter(a,["background","border-radius","bottom","color","font-size","height","left","margin-top","right","top","width","z-index","position"]),e=b(c.width);return e&&(c["margin-left"]=e),e=b(c.height),e&&(c["margin-top"]=e),c}var d=(a("$"),a("Style"));return{get:c}}),C("Navigator",function(a,b){function c(a){g.setGuid(this);var b=a.hash,c=f.require("Emitter"),e=new c(this),i={emitter:e,statcks:[],quiet:!1,hash:b};if(h.set(this,i),b){var j=this,k=f.require("Url");k.hashchange(d,function(a,b){e.fire("hash-change",[a,b]);var c=i.quiet;return c?void(i.quiet=!1):void j.back()})}}var e=a("$"),f=a("MiniQuery"),g=f.require("Mapper"),h=new g;c.prototype={constructor:c,on:function(){var a=h.get(this),b=a.emitter,c=[].slice.call(arguments,0);b.on.apply(b,c)},to:function(a){var b=h.get(this),c=b.emitter,g=b.statcks,i=g.slice(-1)[0];i&&(c.fire("before-to",i),c.fire("before-to",[i,a])),g.push(a);var j=[].slice.call(arguments,0);c.fire("to",a,j.slice(1)),c.fire("to",j),c.fire("change",[i,a]);var k=b.hash;if(k=k?"function"==typeof k?k.call(this,a):"string"==typeof k?k+a:k===!0?e.String.random():!1:!1){b.quiet=!0;var l=f.require("Url");l.setHash(d,k)}},back:function(a){if(a=a||1,0>a)throw new r("要后退的步数必须大于 0");var b=h.get(this),c=b.statcks,d=c.length-1,e=d-a;if(!(0>e)){var f=c[d],g=c[e];c.splice(e+1);var i=b.emitter;return i.fire("back",[f,g]),i.fire("change",[f,g]),g}},remove:function(a,b){if(0>a)throw new r("要移除的开始索引值必须大于或等于 0");if(b=b||1,0>b)throw new r("要移除的个数必须大于 0");var c=h.get(this),d=c.statcks,e=d.length-1,f=a+b;if(f>e)throw new r("要移除的结束索引不能包括当前索引: "+e);d.splice(a,b)},removeLast:function(a,b){if(1==arguments.length)b=a,a=1;else if(1>a)throw new r("要移除的开始索引值必须大于等于 1");if(0>b)throw new r("要移除的个数必须大于 0");var c=h.get(this),d=c.statcks;d.reverse(),d.splice(a,b),c.statcks=d.reverse()},count:function(){var a=h.get(this);return a.statcks.length}},b.exports=c}),C("Panel",function(a,b){function c(a,c){f.setGuid(this),d.Object.isPlain(a)&&(c=a,a=c.el,delete c.el),c=h.clone(b.id,c);var e={emitter:new g(this),outerEmitter:new g,container:a,rendered:!1,showAfterRender:c.showAfterRender,cssClass:c.cssClass,visible:!1,byRender:!1};i.set(this,e),this.$=d(a)}var d=a("$"),e=a("MiniQuery"),f=e.require("Mapper"),g=e.require("Emitter"),h=a("Config"),i=new f;return c.prototype={constructor:c,$:null,show:function(){var a=i.get(this),b=a.container,c=a.emitter;b=d(b);var e=[].slice.call(arguments);b.show.apply(b,e),a.visible=!0;var f=a.byRender;a.byRender=!1,c.fire("show",[f])},hide:function(){var a=i.get(this),b=a.container,c=a.emitter;b=d(b);var e=[].slice.call(arguments);b.hide.apply(b,e),a.visible=!1,c.fire("hide")},toggle:function(a){var b=i.get(this),c=b.visible;0==arguments.length?c?this.hide():this.show():c&&!a?this.hide():!c&&a&&this.show()},fill:function(b,c){var d=a("Template"),e=i.get(this),f=e.container,g=e.emitter;d.fill(f,b,c),g.fire("fill",[b])},render:function(){var a=[].slice.call(arguments),b=i.get(this),c=b.emitter,e=b.container,f=b.cssClass,g=b.rendered;g||c.fire("init",a),c.fire("before-render",a),d(e).addClass(f),c.fire("render",a),b.rendered=!0,b.showAfterRender&&(b.byRender=!0,this.show()),c.fire("after-render",a)},refresh:function(){var a=i.get(this),b=a.emitter,c=[].slice.call(arguments);b.fire("refresh",c)},reset:function(){var a=i.get(this),b=a.emitter,c=[].slice.call(arguments);b.fire("reset",c)},visible:function(){var a=i.get(this);return a.visible},rendered:function(){var a=i.get(this);return a.rendered},destroy:function(){var a=i.get(this),b=a.emitter;b.destroy(),i.remove(this)},on:function(){var a=i.get(this),b=a.emitter,c=[].slice.call(arguments,0);b.on.apply(b,c)},fire:function(a,b){var c=i.get(this),d=c.outerEmitter,b=[].slice.call(arguments,0);d.fire.apply(d,b)},wrap:function(a){var b=i.get(this),c=b.outerEmitter,e={on:function(){var a=[].slice.call(arguments,0);c.on.apply(c,a)}};for(var f in this)if("_"!=f.slice(0,1)&&!/^(constructor|fire|on|wrap)$/g.test(f)){var g=this[f];"function"==typeof g&&(g=g.bind(this)),e[f]=g}return a?d.Object.extend(e,a):e}},c}),C("Tabs",function(a,b){function c(a,c){f.setGuid(this),d.Object.isPlain(a)&&(c=a,a=c.container),c=h.clone(b.id,c);var e={emitter:new g(this),container:a,activedIndex:-1,activedNode:null,activedClass:c.activedClass,pressedClass:c.pressedClass,repeated:c.repeated,eventName:c.eventName,list:[],indexKey:c.field.index,eventKey:c.field.event,nodes:null,selector:c.selector,change:null,old:null};j.set(this,e);var i=c.list;i&&this.render(i);var k=c.current;"number"==typeof k&&this.active(k);var l=c.change;l&&this.on("change",l)}var d=a("$"),e=a("MiniQuery"),f=e.require("Mapper"),g=e.require("Emitter"),h=a("Config"),i=(a("RandomId"),b.require("Helper")),j=new f;return c.prototype={constructor:c,render:function(b,c){var d=j.get(this),e=d.container;if(b){var f=a("Template");f.fill(e,b,c),d.list=b,d.nodes=null,d.activedNode=null,d.activedIndex=-1}if(!d.change){var g=d.eventName,h=d.selector,k=d.pressedClass,l=this,m=d.change=function(){var a=i.getIndex(d,this);l.active(a)};if("touch"==g){var n=a("jquery-plugin/touch");n(e).touch(h,m,k)}else{var n=a("$");n(e).on(g,h,m)}}},active:function(a,b){var c=j.get(this),e=c.list;"number"!=typeof a&&(a=i.findIndex(e,a,arguments[1]));var f=c.activedIndex,g=a==f;if(!g||c.repeated){var h=c.activedNode;if(!g){f=c.activedIndex=a;var k=c.activedClass;h&&d(h).removeClass(k),h=c.activedNode=i.getNode(c,a),d(h).addClass(k)}var l=c.emitter,m=e[a],n={item:m,index:a,element:h,event:event},o=c.old;if(c.old=n,!b){var p=[m,a,n,o];l.fire("before-change",p),l.fire("change",a,p);var q=c.eventKey;q&&l.fire("change",x(m[q]),p),l.fire("change",p)}}},show:function(){var a=j.get(this),b=a.container;d(b).show()},hide:function(){var a=j.get(this),b=a.container;d(b).hide()},on:function(){var a=j.get(this),b=a.emitter,c=[].slice.call(arguments,0);b.on.apply(b,c)},destroy:function(){var a=j.get(this),b=a.emitter;b.destroy();var c=a.container,e=a.eventName,f=a.selector,g=a.change;d(c).off(e,f,g),j.remove(this)}},d.Object.extend(c,{}),c}),C("Tabs/Helper",function(a){function b(a){var b=a.nodes;return b||(b=a.nodes=f(a.container).find(a.selector).toArray()),b}function c(a,c){var d=a.indexKey,e=c.getAttribute(d);if(e)return+e;var g=b(a);return f.Array.findIndex(g,function(a){return a===c})}function d(a,c){var d=b(a);return d[c]}function e(a,b,c){var d=typeof b;if("object"==d)return f.Array.findIndex(a,function(a){return b===a});if("string"==d)return f.Array.findIndex(a,function(a){return a[b]===c});if("function"==d)return f.Array.findIndex(a,b);throw new r("无法识别的参数 key: "+d)}var f=a("$");return{getIndex:c,getNode:d,findIndex:e}}),C("Template",function(a,b){function c(a,c){f.setGuid(this),c=h.clone(b.id,c);var d={container:a,names:c.names,list:c.list,fn:c.fn,outer:c.outer,root:c.root,item:c.item,emitter:new g,info:null,sample:""};l.set(this,d)}var d=a("$"),e=a("MiniQuery"),f=e.require("Mapper"),g=e.require("Emitter"),h=a("Config"),i=b.require("Multiple"),j=b.require("Simple"),k=b.require("Static"),l=new f;return c.prototype={constructor:c,fill:function(a,b){"function"==typeof a&&(b=a,a=null);var c=l.get(this);a=a||c.list,b=b||c.fn;var e=c.names,f=e&&e.length?i.getHTML(c,0,a,b):j.getHTML(c,a,b);d(c.container).html(f),c.emitter.fire("fill")},on:function(){var a=l.get(this),b=a.emitter,c=[].slice.call(arguments,0);b.on.apply(b,c)}},d.Object.extend(c,k)}),C("Template/Multiple",function(a){function b(a){var b=a.names,c=a.outer,e=a.item.begin,f=a.item.end,g={},h=d.Array.keep(b,function(a){var b=d.String.random(c);g[a]=b;var h={name:a},i={name:a,begin:d.String.format(e,h),end:d.String.format(f,h),outer:"{"+b+"}"};return i});h=[{name:d.String.random(),begin:a.root.begin,end:a.root.end}].concat(h);var i=a.container,j=d(i).html(),k=d.String.getTemplates(j,h);return{name$outer:g,tags:h,samples:k}}function c(a,c,e,f){function g(a,b,c){var e=i[a],f=e.name,h=j[f];return d.Array.keep(b,function(b,e){var f=c(b,e),j=f.data||{},l=a+1,m=i[l];if(m){var n=k[m.name];n&&(j[n]=g(l,f.list,f.fn))}var o=d.String.format(h,j);return o}).join("")}var h=a.info=a.info||b(a),i=h.tags,j=h.samples,k=h.name$outer;return g(c,e,f)}var d=a("$");return{getHTML:c}}),C("Template/Simple",function(a){function b(a){var b=a.container,c=a.root,e=d(b).html(),f=d.String.between(e,c.begin,c.end);return f}function c(a,c,e){var f,g=a.sample=a.sample||b(a);f=c instanceof o?d.Array.keep(c,function(a,b){return e&&(a=e(a,b)),d.String.format(g,a)}).join(""):d.String.format(g,c),d(a.container).html(f)}var d=a("$");return{getHTML:c}}),C("Template/Static",function(a,b){function c(a,b,g){if(f.Object.isPlain(a))return g=b,void f.Object.each(a,function(a,b){c(a,b,g)});if("string"==typeof a){var i=a;0==i.indexOf("#")&&(i=i.slice(1)),a=e.getElementById(i)}var j=d(a);a.innerHTML=b instanceof o?f.Array.keep(b,function(a,b){return g&&(a=g(a,b)),h(j,a)}).join(""):h(j,b)}function d(a){var b;"string"==typeof a?(b=a,0==b.indexOf("#")&&(b=b.slice(1)),a=e.getElementById(b)):(b=a.id,b||(b=a.getAttribute(j),b||(b=a.tagName.toLowerCase()+"-"+f.String.random(),a.setAttribute(j,b))));var c=i[b];if(!c){var d=k.root;c=f.String.between(a.innerHTML,d.begin,d.end),i[b]=c}return c}var f=a("$"),g=a("Config"),h=f.String.format,i={},j="data-template-id-"+f.String.random(4).toLowerCase(),k=g.get(b.parent.id);return{fill:c,get:d}}),C("View",function(a,b){function c(c,e){e=d.clone(b.id,e);var f=a("Panel"),g=new f(c,e);g.$.addClass("KISP View");var h=e.background;return h&&g.$.css("background",h),g}var d=a("Config");return c}),C("API.defaults",{successCode:200,field:{code:"code",msg:"msg",data:"data"},proxy:null,delay:!1,random:!0,url:"",prefix:"",ext:"",data:null,query:null,timeout:0,serialize:function(a,b){var c=D("$"),d=c.Object.toJson(b);return encodeURIComponent(d)}}),C("Proxy.defaults",{base:"",delay:{min:500,max:3e3}}),C("LocalStorage.defaults",{name:""}),C("Module.defaults",{seperator:"/",crossover:!1,repeated:!1}),C("SessionStorage.defaults",{name:""}),C("Url.defaults",{root:f.protocol+"//"+f.host+f.pathname.split("/").slice(0,-1).join("/")+"/",replacer:{root:"~",edition:"@"}}),C("Alert.defaults",{button:"确定","volatile":!1,mask:!0,autoClosed:!0,width:"80%","z-index":99999}),C("App.defaults",{mask:{opacity:0,duration:500,"z-index":99999},type:"simple"}),C("Dialog.defaults",{prefix:"KISP-Dialog-",suffix:4,mask:!0,scrollable:!0,scroller:{},autoClosed:!0,"volatile":!1,title:"",text:"","z-index":1024,sample:"iOS",cssClass:"",eventName:"touch",width:"80%",height:"50%",buttons:[]}),C("Loading.defaults",{prefix:"KISP-Loading-",suffix:4,text:"处理中...",mask:!1,sample:"iOS",cssClass:"",container:e.body,append:!1,background:"rgba(0, 0, 0, 0.7)","border-radius":10,bottom:"initial",color:"#fff","font-size":"15px",height:102,left:"50%",right:"initial",top:"50%",width:120,"z-index":1024}),C("Mask.defaults",{prefix:"KISP-Mask-",suffix:4,"volatile":!1,container:e.body,append:!1,eventName:"touch",top:0,bottom:0,opacity:.5,background:"#000","z-index":1024}),C("Panel.defaults",{showAfterRender:!0,cssClass:""}),C("Tabs.defaults",{current:null,eventName:"touch",pressedClass:"",activedClass:"",selector:">*",repeated:!1,field:{index:"data-index",event:""}}),C("Template.defaults",{root:{begin:"<!--",end:"-->"},item:{begin:"#--{name}.begin--#",end:"#--{name}.end--#"},outer:64}),C("Toast.defaults",{prefix:"KISP-Toast-",suffix:4,text:"",container:e.body,append:!1,mask:!1,sample:"font-awesome",cssClass:"",icon:"check",duration:0}),C("View.defaults",{background:!1}),C("Alert.config",{width:450}),C("Dialog.config",{scrollable:!1,scroller:null,eventName:"click",position:"fixed"}),C("Loading.config",{position:"fixed"}),C("Mask.config",{position:"fixed"}),C("Tabs.config",{eventName:"click"}),C("Toast.config",{position:"fixed"}),B.expose({API:!0,"SSH.API":!0,$:!0,MiniQuery:!0,MD5:!0,Edition:!0,LocalStorage:!0,Mapper:!0,Module:!0,SessionStorage:!0,Style:!0,Url:!0,Dialog:!0,Loading:!0,Mask:!0,Navigator:!0,NoData:!0,Panel:!0,Tabs:!0,Template:!0,Toast:!0,View:!0}),function(b){var c=b("KISP");a.KISP=c,delete a.$,delete a.MiniQuery}(B.require)}(window,top,parent,window,document,location,navigator,window.localStorage,window.sessionStorage,window.console,history,setTimeout,setInterval,window.JSON,Array,Boolean,Date,Error,Function,Math,Number,Object,RegExp,String,jQuery,MiniQuery);